# å›æµ‹ç³»ç»Ÿæµ‹è¯•æŒ‡å—

## ğŸ¯ æµ‹è¯•ç›®æ ‡

éªŒè¯å›æµ‹ç³»ç»Ÿçš„å®Œæ•´åŠŸèƒ½ï¼ŒåŒ…æ‹¬ï¼š
1. æ•°æ®åº“è¿ç§»
2. åç«¯API
3. å‰ç«¯ç®¡ç†ç•Œé¢
4. æ•°æ®ä¸‹è½½åŠŸèƒ½

## ğŸ“‹ å‰ç½®æ¡ä»¶

### 1. å®‰è£…ä¾èµ–

```bash
# Backend dependencies
cd packages/backend
npm install unzipper @types/unzipper

# Frontend dependencies (if needed)
cd ../frontend
npm install
```

### 2. ç¡®ä¿æ•°æ®åº“è¿è¡Œ

```bash
# å¯åŠ¨PostgreSQLå’ŒRedis
docker-compose up postgres redis -d

# æˆ–ä½¿ç”¨è„šæœ¬
./start-databases.sh  # Linux/Mac
start-databases.bat   # Windows
```

### 3. é…ç½®ç¯å¢ƒå˜é‡

ç¡®ä¿ `packages/backend/.env` åŒ…å«ï¼š
```env
DATABASE_URL=postgresql://user:password@localhost:5432/multi_agent_platform
REDIS_URL=redis://localhost:6379
```

## ğŸ§ª æµ‹è¯•æ­¥éª¤

### Step 1: è¿è¡Œæ•°æ®åº“è¿ç§»

```bash
cd packages/backend
npm run db:migrate
```

**é¢„æœŸç»“æœ**:
- âœ… åˆ›å»º6ä¸ªæ–°è¡¨
- âœ… æ˜¾ç¤º "Migration 006_backtest_system.sql completed"

### Step 2: æµ‹è¯•åç«¯ç³»ç»Ÿ

```bash
npx tsx src/test-backtest-system.ts
```

**é¢„æœŸç»“æœ**:
```
ğŸ§ª Testing Backtest System

1ï¸âƒ£  Testing database connection...
âœ… Database connected

2ï¸âƒ£  Initializing services...
âœ… Services initialized

3ï¸âƒ£  Testing available symbols...
âœ… Found 10 symbols: BTCUSDT, ETHUSDT, BNBUSDT, ...

4ï¸âƒ£  Testing database queries...
âœ… Found 0 symbols in database

5ï¸âƒ£  Testing storage statistics...
âœ… Storage stats: { totalDatasets: 0, totalSize: '0.00 MB' }

âœ… All tests passed!
```

### Step 3: å¯åŠ¨åç«¯æœåŠ¡å™¨

```bash
npm run dev
```

**é¢„æœŸç»“æœ**:
- âœ… Server listening on port 3001
- âœ… Database connected
- âœ… Redis connected (optional)

### Step 4: æµ‹è¯•APIç«¯ç‚¹

åœ¨æ–°ç»ˆç«¯çª—å£ï¼š

#### æµ‹è¯•ç®¡ç†ç«¯ç‚¹ï¼ˆlocalhost onlyï¼‰

```bash
# åˆ—å‡ºå¯ç”¨äº¤æ˜“å¯¹
curl http://localhost:3001/api/admin/data/symbols

# è·å–å­˜å‚¨ç»Ÿè®¡
curl http://localhost:3001/api/admin/data/storage

# åˆ—å‡ºæ•°æ®é›†
curl http://localhost:3001/api/admin/data/datasets
```

**é¢„æœŸç»“æœ**: è¿”å›JSONå“åº”ï¼Œæ— 403é”™è¯¯

#### æµ‹è¯•å…¬å¼€ç«¯ç‚¹

```bash
# åˆ—å‡ºå¯ç”¨æ•°æ®é›†
curl http://localhost:3001/api/data/datasets

# è·å–å¯ç”¨äº¤æ˜“å¯¹
curl http://localhost:3001/api/data/symbols
```

**é¢„æœŸç»“æœ**: è¿”å›JSONå“åº”

### Step 5: å¯åŠ¨å‰ç«¯æœåŠ¡å™¨

åœ¨æ–°ç»ˆç«¯çª—å£ï¼š

```bash
cd packages/frontend
npm run dev
```

**é¢„æœŸç»“æœ**:
- âœ… Server listening on port 3000

### Step 6: è®¿é—®ç®¡ç†ç•Œé¢

åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ï¼š

1. **ä¸»ç®¡ç†é¡µé¢**: http://localhost:3000/data-admin
   - âœ… æ˜¾ç¤º "Localhost Access Verified"
   - âœ… æ˜¾ç¤º3ä¸ªç®¡ç†å¡ç‰‡

2. **ä¸‹è½½æ•°æ®é¡µé¢**: http://localhost:3000/data-download
   - âœ… æ˜¾ç¤ºå¸‚åœºç±»å‹é€‰æ‹©
   - âœ… æ˜¾ç¤ºäº¤æ˜“å¯¹åˆ—è¡¨
   - âœ… æ˜¾ç¤ºæ—¶é—´å‘¨æœŸé€‰æ‹©
   - âœ… æ˜¾ç¤ºæ—¥æœŸèŒƒå›´é€‰æ‹©

3. **æ•°æ®ç®¡ç†é¡µé¢**: http://localhost:3000/data-management
   - âœ… æ˜¾ç¤ºæ•°æ®é›†åˆ—è¡¨ï¼ˆåˆå§‹ä¸ºç©ºï¼‰
   - âœ… æ˜¾ç¤ºç­›é€‰é€‰é¡¹

4. **å­˜å‚¨ç»Ÿè®¡é¡µé¢**: http://localhost:3000/data-storage
   - âœ… æ˜¾ç¤ºå­˜å‚¨ç»Ÿè®¡
   - âœ… æ˜¾ç¤ºå›¾è¡¨

### Step 7: æµ‹è¯•æ•°æ®ä¸‹è½½ï¼ˆå°æ•°æ®é›†ï¼‰

åœ¨ä¸‹è½½é¡µé¢ï¼š

1. é€‰æ‹© **Market Type**: Spot
2. é€‰æ‹© **Symbol**: BTCUSDTï¼ˆåªé€‰ä¸€ä¸ªï¼‰
3. é€‰æ‹© **Interval**: 1dï¼ˆåªé€‰ä¸€ä¸ªï¼‰
4. è®¾ç½® **Start Date**: 2024-01-01
5. è®¾ç½® **End Date**: 2024-01-31
6. ç‚¹å‡» **Start Download**

**é¢„æœŸç»“æœ**:
- âœ… æ˜¾ç¤º "Download Started!"
- âœ… è¿”å›Job ID
- âœ… åç«¯å¼€å§‹ä¸‹è½½æ–‡ä»¶

### Step 8: ç›‘æ§ä¸‹è½½è¿›åº¦

ä½¿ç”¨APIæ£€æŸ¥ä¸‹è½½çŠ¶æ€ï¼š

```bash
# æ›¿æ¢ {jobId} ä¸ºå®é™…çš„Job ID
curl http://localhost:3001/api/admin/data/download/{jobId}
```

**é¢„æœŸç»“æœ**:
```json
{
  "success": true,
  "status": {
    "id": "...",
    "status": "downloading",
    "progress": {
      "totalFiles": 1,
      "downloadedFiles": 0,
      "downloadedBytes": 0
    }
  }
}
```

### Step 9: éªŒè¯ä¸‹è½½çš„æ•°æ®

ä¸‹è½½å®Œæˆåï¼š

1. åˆ·æ–° **æ•°æ®ç®¡ç†é¡µé¢**
   - âœ… æ˜¾ç¤ºæ–°ä¸‹è½½çš„æ•°æ®é›†
   - âœ… æ˜¾ç¤ºæ­£ç¡®çš„ç»Ÿè®¡ä¿¡æ¯

2. æŸ¥çœ‹ **å­˜å‚¨ç»Ÿè®¡é¡µé¢**
   - âœ… æ›´æ–°çš„å­˜å‚¨ä½¿ç”¨é‡
   - âœ… æŒ‰å¸‚åœºç±»å‹å’Œæ—¶é—´å‘¨æœŸçš„åˆ†å¸ƒ

3. æ£€æŸ¥æ–‡ä»¶ç³»ç»Ÿï¼š
```bash
ls -la data/historical/spot/BTCUSDT/1d/
```
   - âœ… å­˜åœ¨CSVæ–‡ä»¶

### Step 10: æµ‹è¯•æ•°æ®æŸ¥è¯¢

ä½¿ç”¨å…¬å¼€APIæŸ¥è¯¢æ•°æ®ï¼š

```bash
curl -X POST http://localhost:3001/api/data/klines/query \
  -H "Content-Type: application/json" \
  -d '{
    "symbol": "BTCUSDT",
    "interval": "1d",
    "marketType": "spot",
    "startDate": "2024-01-01",
    "endDate": "2024-01-31",
    "limit": 10
  }'
```

**é¢„æœŸç»“æœ**: è¿”å›Kçº¿æ•°æ®æ•°ç»„

## âœ… æµ‹è¯•æ£€æŸ¥æ¸…å•

### åç«¯
- [ ] æ•°æ®åº“è¿ç§»æˆåŠŸ
- [ ] æµ‹è¯•è„šæœ¬é€šè¿‡
- [ ] æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ
- [ ] ç®¡ç†APIå“åº”æ­£å¸¸
- [ ] å…¬å¼€APIå“åº”æ­£å¸¸
- [ ] élocalhostè®¿é—®ç®¡ç†APIè¿”å›403

### å‰ç«¯
- [ ] å‰ç«¯æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ
- [ ] ä¸»ç®¡ç†é¡µé¢åŠ è½½
- [ ] æœ¬åœ°è®¿é—®æ£€æµ‹å·¥ä½œ
- [ ] ä¸‹è½½é¡µé¢æ˜¾ç¤ºæ­£å¸¸
- [ ] ç®¡ç†é¡µé¢æ˜¾ç¤ºæ­£å¸¸
- [ ] ç»Ÿè®¡é¡µé¢æ˜¾ç¤ºæ­£å¸¸

### åŠŸèƒ½
- [ ] å¯ä»¥å¯åŠ¨æ•°æ®ä¸‹è½½
- [ ] ä¸‹è½½è¿›åº¦è·Ÿè¸ªå·¥ä½œ
- [ ] æ•°æ®æ­£ç¡®å­˜å‚¨åˆ°æ–‡ä»¶ç³»ç»Ÿ
- [ ] æ•°æ®é›†å…ƒæ•°æ®ä¿å­˜åˆ°æ•°æ®åº“
- [ ] å¯ä»¥æŸ¥è¯¢ä¸‹è½½çš„æ•°æ®
- [ ] å¯ä»¥åˆ é™¤æ•°æ®é›†
- [ ] å­˜å‚¨ç»Ÿè®¡æ­£ç¡®è®¡ç®—

## ğŸ› å¸¸è§é—®é¢˜

### 1. "403 Forbidden" on Admin Endpoints

**é—®é¢˜**: è®¿é—®ç®¡ç†ç«¯ç‚¹è¿”å›403
**è§£å†³**: ç¡®ä¿ä½¿ç”¨ `localhost` æˆ– `127.0.0.1` è®¿é—®

### 2. "unzipper not found"

**é—®é¢˜**: ç¼ºå°‘unzipperä¾èµ–
**è§£å†³**: 
```bash
cd packages/backend
npm install unzipper @types/unzipper
```

### 3. Database Connection Error

**é—®é¢˜**: æ— æ³•è¿æ¥æ•°æ®åº“
**è§£å†³**:
- æ£€æŸ¥PostgreSQLæ˜¯å¦è¿è¡Œ
- éªŒè¯DATABASE_URLé…ç½®
- è¿è¡Œ `npm run db:migrate`

### 4. Download Fails

**é—®é¢˜**: æ•°æ®ä¸‹è½½å¤±è´¥
**è§£å†³**:
- æ£€æŸ¥ç½‘ç»œè¿æ¥
- éªŒè¯äº¤æ˜“å¯¹åç§°æ­£ç¡®
- æ£€æŸ¥æ—¥æœŸèŒƒå›´æ˜¯å¦æœ‰æ•°æ®
- æŸ¥çœ‹åç«¯æ—¥å¿—

### 5. Frontend Can't Connect to Backend

**é—®é¢˜**: å‰ç«¯æ— æ³•è¿æ¥åç«¯
**è§£å†³**:
- ç¡®ä¿åç«¯åœ¨3001ç«¯å£è¿è¡Œ
- æ£€æŸ¥CORSé…ç½®
- éªŒè¯API_URLç¯å¢ƒå˜é‡

## ğŸ“Š æ€§èƒ½åŸºå‡†

### å°æ•°æ®é›†ï¼ˆ1ä¸ªæœˆï¼Œ1ä¸ªäº¤æ˜“å¯¹ï¼Œ1då‘¨æœŸï¼‰
- æ–‡ä»¶æ•°: 1
- å¤§å°: ~50 MB
- ä¸‹è½½æ—¶é—´: ~30ç§’
- å¤„ç†æ—¶é—´: ~5ç§’

### ä¸­ç­‰æ•°æ®é›†ï¼ˆ1å¹´ï¼Œ1ä¸ªäº¤æ˜“å¯¹ï¼Œ1hå‘¨æœŸï¼‰
- æ–‡ä»¶æ•°: 12
- å¤§å°: ~600 MB
- ä¸‹è½½æ—¶é—´: ~5åˆ†é’Ÿ
- å¤„ç†æ—¶é—´: ~1åˆ†é’Ÿ

### å¤§æ•°æ®é›†ï¼ˆ1å¹´ï¼Œ10ä¸ªäº¤æ˜“å¯¹ï¼Œå¤šå‘¨æœŸï¼‰
- æ–‡ä»¶æ•°: 100+
- å¤§å°: ~5 GB
- ä¸‹è½½æ—¶é—´: ~30åˆ†é’Ÿ
- å¤„ç†æ—¶é—´: ~10åˆ†é’Ÿ

## ğŸ‰ æˆåŠŸæ ‡å‡†

ç³»ç»Ÿæµ‹è¯•æˆåŠŸçš„æ ‡å‡†ï¼š

1. âœ… æ‰€æœ‰APIç«¯ç‚¹å“åº”æ­£å¸¸
2. âœ… å¯ä»¥æˆåŠŸä¸‹è½½è‡³å°‘ä¸€ä¸ªæ•°æ®é›†
3. âœ… ä¸‹è½½çš„æ•°æ®å¯ä»¥æŸ¥è¯¢
4. âœ… å‰ç«¯ç•Œé¢æ­£å¸¸æ˜¾ç¤º
5. âœ… æœ¬åœ°è®¿é—®æ§åˆ¶å·¥ä½œæ­£å¸¸
6. âœ… å­˜å‚¨ç»Ÿè®¡å‡†ç¡®
7. âœ… å¯ä»¥åˆ é™¤æ•°æ®é›†

## ğŸ“ æµ‹è¯•æŠ¥å‘Šæ¨¡æ¿

```
æµ‹è¯•æ—¥æœŸ: ____________________
æµ‹è¯•äººå‘˜: ____________________

åç«¯æµ‹è¯•:
- æ•°æ®åº“è¿ç§»: [ ] é€šè¿‡ [ ] å¤±è´¥
- APIæµ‹è¯•: [ ] é€šè¿‡ [ ] å¤±è´¥
- ä¸‹è½½åŠŸèƒ½: [ ] é€šè¿‡ [ ] å¤±è´¥

å‰ç«¯æµ‹è¯•:
- ç•Œé¢åŠ è½½: [ ] é€šè¿‡ [ ] å¤±è´¥
- è®¿é—®æ§åˆ¶: [ ] é€šè¿‡ [ ] å¤±è´¥
- æ•°æ®æ˜¾ç¤º: [ ] é€šè¿‡ [ ] å¤±è´¥

åŠŸèƒ½æµ‹è¯•:
- æ•°æ®ä¸‹è½½: [ ] é€šè¿‡ [ ] å¤±è´¥
- æ•°æ®æŸ¥è¯¢: [ ] é€šè¿‡ [ ] å¤±è´¥
- æ•°æ®åˆ é™¤: [ ] é€šè¿‡ [ ] å¤±è´¥

é—®é¢˜è®°å½•:
_________________________________
_________________________________
_________________________________

æ€»ä½“è¯„ä»·: [ ] é€šè¿‡ [ ] éœ€è¦ä¿®å¤
```

---

**å‡†å¤‡å¥½äº†å—ï¼Ÿå¼€å§‹æµ‹è¯•ï¼** ğŸš€
